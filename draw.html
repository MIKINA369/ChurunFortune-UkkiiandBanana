<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Churun Fortune Ⅱ｜風がめくる朝</title>
<link rel="stylesheet" href="style.css">

</head>
<body>

<div class="sky"></div>
<div class="breeze"></div>

<div class="wrap">
  <div>
    <p class="title">🫧 あなたに舞い降りた詩</p>
    <p class="subtitle">静けさののち、風と光が言葉を運ぶ。</p>

    <div id="poemBox" aria-live="polite">
      <p id="poemTitle" style="opacity:.8;margin:.2rem 0 .8rem;"></p>
      <p id="poem"></p>
    </div>

    <a id="reload" href="omikuji.html" aria-label="もう一度、風に触れる">もう一度、風に触れる</a>
  </div>
</div>

<!-- 音：風（先にやさしく）、次に鈴音（光の合図） -->
<audio id="wind" src="https://cdn.pixabay.com/download/audio/2022/03/14/audio_2ce57d3ef8.mp3?filename=soft-wind-ambient-14059.mp3"></audio>
<audio id="bell" src="https://cdn.pixabay.com/download/audio/2021/08/09/audio_8bdb0b7d52.mp3?filename=quiet-wind-chimes-6906.mp3"></audio>

<script>
/** ===== 詩データ（Churun Fortune Ⅱ：20枚） ===== */
const poems = [
  // 🌙夢チュルン ×4
  "眠りの入口で、あなたを呼ぶ声がある。意味を追わずに、その響きのぬくもりだけを聴いて。",
  "夢の続きは、まだ醒めない。朝が来ても、その祈りを閉じないで。",
  "夢の中の誰かは、あなたの中の“もう一人のあなた”。目覚めても、手を離さないで。",
  "懐かしさは、魂の“ただいま”。夢の景色は、あなたが帰る場所。",
  // 🕯灯火チュルン ×4
  "あなたの灯は、まだ消えていない。闇の中ほど、美しく燃える。",
  "言葉にならない想いは、光になる。あなたの沈黙も、ちゃんと世界を照らしている。",
  "希望は探すものじゃない。あなたの中で静かに燃えている。",
  "あたたかさを感じた瞬間、それが愛の灯の在りか。",
  // 🌊記憶チュルン ×4
  "あの日の涙は、いま光になってあなたの瞳に宿っている。泣いた日の分だけ、世界がやさしく見える。",
  "記憶のなかのあなたは、まだ息をしている。思い出すたびに、愛が少しずつ息を吹き返す。",
  "心が疼くのは、再会の前触れ。愛は終わってなどいなかった。",
  "言えなかった言葉は、風に乗って届いている。ありがとうは、時を越える魔法。",
  // 🌬境界チュルン ×4
  "手放すたび、あなたの中の音が澄んでいく。失うことは、響きを取り戻すこと。",
  "止まることも、進むこと。風が動くまで、空を見上げていよう。",
  "時は螺旋。あなたが笑えば、すべての瞬間が癒されていく。",
  "越えていく時、あなたは“まんなか”に戻っていく。別れは、光の形を変えるだけ。",
  // 🌅夜明けチュルン ×4
  "朝の光は、あなたの内側から昇る。何も探さなくていい。あなたが“光そのもの”だから。",
  "昨日のあなたも、美しかった。泣いても笑っても、すべてが“今日”を咲かせている。",
  "信じることをやめても、愛はあなたを離れない。それは“信じなくても続くもの”。だから安心して、ただ息をして。",
  "新しい朝は、あなたの笑顔で始まる。この瞬間こそが、永遠の始まり。"
];

/** ===== 音と光・出現の演出 ===== */
const wind = document.getElementById('wind');
const bell = document.getElementById('bell');
const poemBox = document.getElementById('poemBox');
const poemTitle = document.getElementById('poemTitle');
const poemEl = document.getElementById('poem');
const reloadBtn = document.getElementById('reload');

// 自動再生ポリシー対策：音量と再生の準備
wind.volume = 0.25; bell.volume = 0.20;

window.addEventListener('load', async () => {
  // 風→（少し待って）→鈴音
  try { await wind.play(); } catch(e){ /* ユーザー操作まで待機 */ }
  setTimeout(async ()=>{ try{ await bell.play(); }catch(e){} }, 2200);

  // 夜→朝の光に合わせて、詩がふわり出現
  const text = poems[Math.floor(Math.random()*poems.length)];
  const tag = pickTagByPoemIndex(text);

  poemTitle.textContent = tag + " ";
  // 詩を一文字ずつ描画（ささやき感）
  typePoem(text, poemEl, 22);

  // 詩ボックス出現
  setTimeout(()=>{
    poemBox.style.opacity = 1;
    poemBox.style.transform = 'translateY(0)';
    poemBox.style.filter = 'blur(0)';
  }, 2800);

  // 再抽選ボタン出現
  setTimeout(()=>{
    reloadBtn.style.opacity = 1;
    reloadBtn.style.transform = 'translateY(0)';
  }, 5200);
});

// 詩タイプライタ
function typePoem(text, container, stepMs=24){
  container.innerHTML = '';
  [...text].forEach((ch, i)=>{
    const span = document.createElement('span');
    span.className = 'char';
    span.style.animationDelay = (i*stepMs/1000)+'s';
    span.textContent = ch;
    container.appendChild(span);
  });
}

// 詩の章タグ（簡易にインデックスで分類/後で精密化可）
function pickTagByPoemIndex(t){
  const i = poems.indexOf(t);
  const map = [
    "🌙 夢チュルン","🌙 夢チュルン","🌙 夢チュルン","🌙 夢チュルン",
    "🕯 灯火チュルン","🕯 灯火チュルン","🕯 灯火チュルン","🕯 灯火チュルン",
    "🌊 記憶チュルン","🌊 記憶チュルン","🌊 記憶チュルン","🌊 記憶チュルン",
    "🌬 境界チュルン","🌬 境界チュルン","🌬 境界チュルン","🌬 境界チュルン",
    "🌅 夜明けチュルン","🌅 夜明けチュルン","🌅 夜明けチュルン","🌅 夜明けチュルン"
  ];
  return map[i] || "🫧";
}
</script>
</body>
</html>
