<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Churun Fortune â…¡ï½œé¢¨ãŒã‚ãã‚‹æœ</title>
<link rel="stylesheet" href="style.css">

</head>
<body>

<div class="sky"></div>
<div class="breeze"></div>

<div class="wrap">
  <div>
    <p class="title">ğŸ«§ ã‚ãªãŸã«èˆã„é™ã‚ŠãŸè©©</p>
    <p class="subtitle">é™ã‘ã•ã®ã®ã¡ã€é¢¨ã¨å…‰ãŒè¨€è‘‰ã‚’é‹ã¶ã€‚</p>

    <div id="poemBox" aria-live="polite">
      <p id="poemTitle" style="opacity:.8;margin:.2rem 0 .8rem;"></p>
      <p id="poem"></p>
    </div>

    <a id="reload" href="omikuji.html" aria-label="ã‚‚ã†ä¸€åº¦ã€é¢¨ã«è§¦ã‚Œã‚‹">ã‚‚ã†ä¸€åº¦ã€é¢¨ã«è§¦ã‚Œã‚‹</a>
  </div>
</div>

<!-- éŸ³ï¼šé¢¨ï¼ˆå…ˆã«ã‚„ã•ã—ãï¼‰ã€æ¬¡ã«éˆ´éŸ³ï¼ˆå…‰ã®åˆå›³ï¼‰ -->
<audio id="wind" src="https://cdn.pixabay.com/download/audio/2022/03/14/audio_2ce57d3ef8.mp3?filename=soft-wind-ambient-14059.mp3"></audio>
<audio id="bell" src="https://cdn.pixabay.com/download/audio/2021/08/09/audio_8bdb0b7d52.mp3?filename=quiet-wind-chimes-6906.mp3"></audio>

<script>
/** ===== è©©ãƒ‡ãƒ¼ã‚¿ï¼ˆChurun Fortune â…¡ï¼š20æšï¼‰ ===== */
const poems = [
  // ğŸŒ™å¤¢ãƒãƒ¥ãƒ«ãƒ³ Ã—4
  "çœ ã‚Šã®å…¥å£ã§ã€ã‚ãªãŸã‚’å‘¼ã¶å£°ãŒã‚ã‚‹ã€‚æ„å‘³ã‚’è¿½ã‚ãšã«ã€ãã®éŸ¿ãã®ã¬ãã‚‚ã‚Šã ã‘ã‚’è´ã„ã¦ã€‚",
  "å¤¢ã®ç¶šãã¯ã€ã¾ã é†’ã‚ãªã„ã€‚æœãŒæ¥ã¦ã‚‚ã€ãã®ç¥ˆã‚Šã‚’é–‰ã˜ãªã„ã§ã€‚",
  "å¤¢ã®ä¸­ã®èª°ã‹ã¯ã€ã‚ãªãŸã®ä¸­ã®â€œã‚‚ã†ä¸€äººã®ã‚ãªãŸâ€ã€‚ç›®è¦šã‚ã¦ã‚‚ã€æ‰‹ã‚’é›¢ã•ãªã„ã§ã€‚",
  "æ‡ã‹ã—ã•ã¯ã€é­‚ã®â€œãŸã ã„ã¾â€ã€‚å¤¢ã®æ™¯è‰²ã¯ã€ã‚ãªãŸãŒå¸°ã‚‹å ´æ‰€ã€‚",
  // ğŸ•¯ç¯ç«ãƒãƒ¥ãƒ«ãƒ³ Ã—4
  "ã‚ãªãŸã®ç¯ã¯ã€ã¾ã æ¶ˆãˆã¦ã„ãªã„ã€‚é—‡ã®ä¸­ã»ã©ã€ç¾ã—ãç‡ƒãˆã‚‹ã€‚",
  "è¨€è‘‰ã«ãªã‚‰ãªã„æƒ³ã„ã¯ã€å…‰ã«ãªã‚‹ã€‚ã‚ãªãŸã®æ²ˆé»™ã‚‚ã€ã¡ã‚ƒã‚“ã¨ä¸–ç•Œã‚’ç…§ã‚‰ã—ã¦ã„ã‚‹ã€‚",
  "å¸Œæœ›ã¯æ¢ã™ã‚‚ã®ã˜ã‚ƒãªã„ã€‚ã‚ãªãŸã®ä¸­ã§é™ã‹ã«ç‡ƒãˆã¦ã„ã‚‹ã€‚",
  "ã‚ãŸãŸã‹ã•ã‚’æ„Ÿã˜ãŸç¬é–“ã€ãã‚ŒãŒæ„›ã®ç¯ã®åœ¨ã‚Šã‹ã€‚",
  // ğŸŒŠè¨˜æ†¶ãƒãƒ¥ãƒ«ãƒ³ Ã—4
  "ã‚ã®æ—¥ã®æ¶™ã¯ã€ã„ã¾å…‰ã«ãªã£ã¦ã‚ãªãŸã®ç³ã«å®¿ã£ã¦ã„ã‚‹ã€‚æ³£ã„ãŸæ—¥ã®åˆ†ã ã‘ã€ä¸–ç•ŒãŒã‚„ã•ã—ãè¦‹ãˆã‚‹ã€‚",
  "è¨˜æ†¶ã®ãªã‹ã®ã‚ãªãŸã¯ã€ã¾ã æ¯ã‚’ã—ã¦ã„ã‚‹ã€‚æ€ã„å‡ºã™ãŸã³ã«ã€æ„›ãŒå°‘ã—ãšã¤æ¯ã‚’å¹ãè¿”ã™ã€‚",
  "å¿ƒãŒç–¼ãã®ã¯ã€å†ä¼šã®å‰è§¦ã‚Œã€‚æ„›ã¯çµ‚ã‚ã£ã¦ãªã©ã„ãªã‹ã£ãŸã€‚",
  "è¨€ãˆãªã‹ã£ãŸè¨€è‘‰ã¯ã€é¢¨ã«ä¹—ã£ã¦å±Šã„ã¦ã„ã‚‹ã€‚ã‚ã‚ŠãŒã¨ã†ã¯ã€æ™‚ã‚’è¶Šãˆã‚‹é­”æ³•ã€‚",
  // ğŸŒ¬å¢ƒç•Œãƒãƒ¥ãƒ«ãƒ³ Ã—4
  "æ‰‹æ”¾ã™ãŸã³ã€ã‚ãªãŸã®ä¸­ã®éŸ³ãŒæ¾„ã‚“ã§ã„ãã€‚å¤±ã†ã“ã¨ã¯ã€éŸ¿ãã‚’å–ã‚Šæˆ»ã™ã“ã¨ã€‚",
  "æ­¢ã¾ã‚‹ã“ã¨ã‚‚ã€é€²ã‚€ã“ã¨ã€‚é¢¨ãŒå‹•ãã¾ã§ã€ç©ºã‚’è¦‹ä¸Šã’ã¦ã„ã‚ˆã†ã€‚",
  "æ™‚ã¯èºæ—‹ã€‚ã‚ãªãŸãŒç¬‘ãˆã°ã€ã™ã¹ã¦ã®ç¬é–“ãŒç™’ã•ã‚Œã¦ã„ãã€‚",
  "è¶Šãˆã¦ã„ãæ™‚ã€ã‚ãªãŸã¯â€œã¾ã‚“ãªã‹â€ã«æˆ»ã£ã¦ã„ãã€‚åˆ¥ã‚Œã¯ã€å…‰ã®å½¢ã‚’å¤‰ãˆã‚‹ã ã‘ã€‚",
  // ğŸŒ…å¤œæ˜ã‘ãƒãƒ¥ãƒ«ãƒ³ Ã—4
  "æœã®å…‰ã¯ã€ã‚ãªãŸã®å†…å´ã‹ã‚‰æ˜‡ã‚‹ã€‚ä½•ã‚‚æ¢ã•ãªãã¦ã„ã„ã€‚ã‚ãªãŸãŒâ€œå…‰ãã®ã‚‚ã®â€ã ã‹ã‚‰ã€‚",
  "æ˜¨æ—¥ã®ã‚ãªãŸã‚‚ã€ç¾ã—ã‹ã£ãŸã€‚æ³£ã„ã¦ã‚‚ç¬‘ã£ã¦ã‚‚ã€ã™ã¹ã¦ãŒâ€œä»Šæ—¥â€ã‚’å’²ã‹ã›ã¦ã„ã‚‹ã€‚",
  "ä¿¡ã˜ã‚‹ã“ã¨ã‚’ã‚„ã‚ã¦ã‚‚ã€æ„›ã¯ã‚ãªãŸã‚’é›¢ã‚Œãªã„ã€‚ãã‚Œã¯â€œä¿¡ã˜ãªãã¦ã‚‚ç¶šãã‚‚ã®â€ã€‚ã ã‹ã‚‰å®‰å¿ƒã—ã¦ã€ãŸã æ¯ã‚’ã—ã¦ã€‚",
  "æ–°ã—ã„æœã¯ã€ã‚ãªãŸã®ç¬‘é¡”ã§å§‹ã¾ã‚‹ã€‚ã“ã®ç¬é–“ã“ããŒã€æ°¸é ã®å§‹ã¾ã‚Šã€‚"
];

/** ===== éŸ³ã¨å…‰ãƒ»å‡ºç¾ã®æ¼”å‡º ===== */
const wind = document.getElementById('wind');
const bell = document.getElementById('bell');
const poemBox = document.getElementById('poemBox');
const poemTitle = document.getElementById('poemTitle');
const poemEl = document.getElementById('poem');
const reloadBtn = document.getElementById('reload');

// è‡ªå‹•å†ç”Ÿãƒãƒªã‚·ãƒ¼å¯¾ç­–ï¼šéŸ³é‡ã¨å†ç”Ÿã®æº–å‚™
wind.volume = 0.25; bell.volume = 0.20;

window.addEventListener('load', async () => {
  // é¢¨â†’ï¼ˆå°‘ã—å¾…ã£ã¦ï¼‰â†’éˆ´éŸ³
  try { await wind.play(); } catch(e){ /* ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã¾ã§å¾…æ©Ÿ */ }
  setTimeout(async ()=>{ try{ await bell.play(); }catch(e){} }, 2200);

  // å¤œâ†’æœã®å…‰ã«åˆã‚ã›ã¦ã€è©©ãŒãµã‚ã‚Šå‡ºç¾
  const text = poems[Math.floor(Math.random()*poems.length)];
  const tag = pickTagByPoemIndex(text);

  // ã‚¿ã‚°ãƒãƒƒã‚¸ã‚’ä½œã£ã¦è¿½åŠ 
const badge = document.createElement('span');
badge.classList.add('badge');
const theme = pickThemeByTag(tag);
badge.dataset.theme = theme;
badge.textContent = tag;
poemBox.prepend(badge);

  // è©©ã‚’ä¸€æ–‡å­—ãšã¤æç”»ï¼ˆã•ã•ã‚„ãæ„Ÿï¼‰
  typePoem(text, poemEl, 22);

  // è©©ãƒœãƒƒã‚¯ã‚¹å‡ºç¾
  setTimeout(()=>{
    poemBox.style.opacity = 1;
    poemBox.style.transform = 'translateY(0)';
    poemBox.style.filter = 'blur(0)';
  }, 2800);

  // å†æŠ½é¸ãƒœã‚¿ãƒ³å‡ºç¾
  setTimeout(()=>{
    reloadBtn.style.opacity = 1;
    reloadBtn.style.transform = 'translateY(0)';
  }, 5200);
});

// è©©ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿
function typePoem(text, container, stepMs=24){
  container.innerHTML = '';
  [...text].forEach((ch, i)=>{
    const span = document.createElement('span');
    span.className = 'char';
    span.style.animationDelay = (i*stepMs/1000)+'s';
    span.textContent = ch;
    container.appendChild(span);
  });
}

// è©©ã®ç« ã‚¿ã‚°ï¼ˆç°¡æ˜“ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§åˆ†é¡/å¾Œã§ç²¾å¯†åŒ–å¯ï¼‰
function pickTagByPoemIndex(t){
  const i = poems.indexOf(t);
  const map = [
    "ğŸŒ™ å¤¢ãƒãƒ¥ãƒ«ãƒ³","ğŸŒ™ å¤¢ãƒãƒ¥ãƒ«ãƒ³","ğŸŒ™ å¤¢ãƒãƒ¥ãƒ«ãƒ³","ğŸŒ™ å¤¢ãƒãƒ¥ãƒ«ãƒ³",
    "ğŸ•¯ ç¯ç«ãƒãƒ¥ãƒ«ãƒ³","ğŸ•¯ ç¯ç«ãƒãƒ¥ãƒ«ãƒ³","ğŸ•¯ ç¯ç«ãƒãƒ¥ãƒ«ãƒ³","ğŸ•¯ ç¯ç«ãƒãƒ¥ãƒ«ãƒ³",
    "ğŸŒŠ è¨˜æ†¶ãƒãƒ¥ãƒ«ãƒ³","ğŸŒŠ è¨˜æ†¶ãƒãƒ¥ãƒ«ãƒ³","ğŸŒŠ è¨˜æ†¶ãƒãƒ¥ãƒ«ãƒ³","ğŸŒŠ è¨˜æ†¶ãƒãƒ¥ãƒ«ãƒ³",
    "ğŸŒ¬ å¢ƒç•Œãƒãƒ¥ãƒ«ãƒ³","ğŸŒ¬ å¢ƒç•Œãƒãƒ¥ãƒ«ãƒ³","ğŸŒ¬ å¢ƒç•Œãƒãƒ¥ãƒ«ãƒ³","ğŸŒ¬ å¢ƒç•Œãƒãƒ¥ãƒ«ãƒ³",
    "ğŸŒ… å¤œæ˜ã‘ãƒãƒ¥ãƒ«ãƒ³","ğŸŒ… å¤œæ˜ã‘ãƒãƒ¥ãƒ«ãƒ³","ğŸŒ… å¤œæ˜ã‘ãƒãƒ¥ãƒ«ãƒ³","ğŸŒ… å¤œæ˜ã‘ãƒãƒ¥ãƒ«ãƒ³"
  ];
  return map[i] || "ğŸ«§";
}

  // ğŸ”®ãƒ†ãƒ¼ãƒã‚¿ã‚°ã«å¿œã˜ã¦ã‚¯ãƒ©ã‚¹ã‚’è¿”ã™é–¢æ•°ï¼ˆã“ã“ã‚’è¿½åŠ ï¼ï¼‰
function pickThemeByTag(tag){
  if(tag.includes("å¤¢")) return "dream";
  if(tag.includes("ç¯")) return "light";
  if(tag.includes("è¨˜æ†¶")) return "memory";
  if(tag.includes("å¢ƒç•Œ")) return "border";
  if(tag.includes("å¤œæ˜ã‘")) return "dawn";
  return "default";
}
  
</script>
  <div class="candle" aria-hidden="true">
  <div class="flame"></div>
</div>
</body>
</html>
